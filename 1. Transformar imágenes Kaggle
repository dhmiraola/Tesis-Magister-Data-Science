from PIL import Image
import numpy as np
import os
import glob

def convert_images_to_16bit_grayscale(input_path, output_path):
    for image_file in glob.glob(os.path.join(input_path, '*')):
        with Image.open(image_file) as img:
            # Convertir la imagen a escala de grises de 8 bits
            img_gray = img.convert('L')
            # Cambiar el tipo de datos a 16 bits
            img_16bit = np.array(img_gray, dtype=np.uint16) * 256  
            img_16bit_pil = Image.fromarray(img_16bit)
            base_name = os.path.basename(image_file)
            tiff_file_name = os.path.splitext(base_name)[0] + '.tiff'
            tiff_file_path = os.path.join(output_path, tiff_file_name)
            img_16bit_pil.save(tiff_file_path, format='TIFF')

# Rutas de las imágenes
source_images_path = 'C:/Users/Diego/Desktop/Proyecto de Grado/imagenes/imagenes'
destination_images_path = 'C:/tesis/imagenes/mascaras'
os.makedirs(destination_images_path, exist_ok=True)
convert_images_to_16bit_grayscale(source_images_path, destination_images_path)

print("La conversión de imágenes ha finalizado.")
